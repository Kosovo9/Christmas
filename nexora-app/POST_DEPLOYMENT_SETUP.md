# ðŸš€ Post-Deployment Setup Guide

Congratulations on deploying your Nexora App! To make the application fully functional (payments, database, auth), you need to complete these final configuration steps.

## 1. ðŸ—„ï¸ Database Setup (Supabase)

Your application needs specific tables to store user credits, transactions, and images.

1.  **Log in to Supabase**: Go to [supabase.com](https://supabase.com) and open your project.
2.  **Go to SQL Editor**: Click on the SQL icon in the left sidebar.
3.  **New Query**: Click "New query".
4.  **Copy Schema**: Open the file `supabase_schema.sql` from your project, copy all its content, and paste it into the SQL Editor.
5.  **Run**: Click the "Run" button.
    *   *Success*: You should see "Success. No rows returned."
6.  **Verify**: Go to the "Table Editor" (Table icon) and ensure you see tables like `user_credits`, `transactions`, `newsletter_subscribers`, etc.

## 1.5 ðŸ“¦ Storage Setup (Supabase)

For real photo uploads to work, you need a storage bucket.

1.  **Go to Storage**: Click on the Storage icon in the left sidebar.
2.  **Create Bucket**: Click "New Bucket".
3.  **Name**: Enter `user-uploads`.
4.  **Public**: Make sure "Public bucket" is **CHECKED**.
5.  **Save**: Click "Save".
6.  **Policies**: You may need to add a policy to allow uploads.
    *   Click "Configuration" > "Policies" next to `user-uploads`.
    *   Click "New Policy" > "For full customization".
    *   Name: "Allow public uploads".
    *   Allowed operations: INSERT, SELECT.
    *   Target roles: `anon`, `authenticated`.
    *   Click "Review" and "Save".

## 2. ðŸ’³ Stripe Webhook Configuration

To automatically credit users after payment, you need to set up a Stripe Webhook.

1.  **Log in to Stripe**: Go to [dashboard.stripe.com](https://dashboard.stripe.com).
2.  **Developers > Webhooks**: Click on the "Developers" tab, then "Webhooks".
3.  **Add Endpoint**: Click "Add endpoint".
4.  **Endpoint URL**: Enter your production URL + `/api/payment/webhook`.
    *   Example: `https://nexora-app.vercel.app/api/payment/webhook`
5.  **Select Events**: Click "Select events" and choose:
    *   `checkout.session.completed`
6.  **Add Endpoint**: Click "Add endpoint".
7.  **Get Secret**: On the webhook details page, look for "Signing secret" and click "Reveal". Copy this secret (starts with `whsec_`).
8.  **Update Vercel**:
    *   Go to your Vercel Project Settings > Environment Variables.
    *   Find `STRIPE_WEBHOOK_SECRET`.
    *   Edit it and paste the secret you just copied.
    *   **Redeploy**: You might need to redeploy (or just wait a moment) for changes to take effect.

## 3. ðŸ‘¤ Clerk Authentication

Ensure your Clerk keys are correctly set in Vercel.

1.  **Check Keys**: In Vercel Environment Variables, verify you have:
    *   `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`
    *   `CLERK_SECRET_KEY`
2.  **Production Paths**: In Clerk Dashboard > Paths, ensure:
    *   Sign-in: `/sign-in`
    *   Sign-up: `/sign-up`
    *   Home: `/`

## 4. ðŸ§ª Final Verification

1.  **Visit your App**: Go to your production URL.
2.  **Sign In**: Create an account or sign in.
3.  **Test Payment**:
    *   Click "Unlock All" or buy a pack.
    *   Complete a test payment (if in test mode) or real payment.
    *   **Verify**: You should be redirected back with a celebration animation, and your credits should update (if you check the database).
4.  **Test Newsletter**: Subscribe to the newsletter and check the `newsletter_subscribers` table in Supabase.

## ðŸ†˜ Troubleshooting

*   **Payment not updating credits?** Check Vercel Logs for the `/api/payment/webhook` route. If you see "Webhook signature verification failed", your `STRIPE_WEBHOOK_SECRET` is incorrect.
*   **Database errors?** Ensure you ran the SQL schema script successfully.

---
*Generated by Antigravity AI*
